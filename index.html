<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ITéƒ¨ãƒœãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ä¸€è¦§</title>

  <style>
    :root {
      --bg: #f4f6f8;
      --card-bg: #ffffff;
      --text-main: #1f2937;
      --text-sub: #6b7280;
      --accent: #2563eb;
      --border-radius: 14px;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text-main);
    }

    h1 {
      text-align: center;
      padding: 24px 12px;
      margin: 0;
    }

    #list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
      gap: 20px;
      padding: 0 20px 40px;
      max-width: 1300px;
      margin: 0 auto;
    }

    /* =========================
       ã‚«ãƒ¼ãƒ‰
    ========================= */
    .game-card {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
      overflow: hidden;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .game-card:hover {
      transform: translateY(-6px);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.16);
    }

    /* =========================
       ç”»åƒ
    ========================= */
    .image {
      width: 100%;
      aspect-ratio: 16 / 9;
      background: #e5e7eb;
      overflow: hidden;
    }

    .image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .no-image {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #9ca3af;
    }

    /* =========================
       å†…å®¹
    ========================= */
    .description {
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .title {
      font-size: 1.15rem;
      font-weight: 700;
    }

    .genre {
      font-size: 0.85rem;
      color: var(--text-sub);
    }

    .summary {
      margin: 8px 0;
      font-size: 0.9rem;
      line-height: 1.5;
    }

    /* ãƒ¡ã‚¿æƒ…å ± */
    .meta {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 6px;
    }

    .badge {
      background: #eef2ff;
      color: #3730a3;
      font-size: 0.75rem;
      padding: 4px 8px;
      border-radius: 999px;
      white-space: nowrap;
    }

    a {
      margin-top: 10px;
      align-self: flex-start;
      font-size: 0.85rem;
      color: var(--accent);
      text-decoration: none;
      font-weight: 600;
    }

    a:hover {
      text-decoration: underline;
    }

    /* =========================
       ãƒ•ã‚£ãƒ«ã‚¿UI
    ========================= */
    .controls {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .controls input,
    .controls select {
      padding: 8px 12px;
      font-size: 0.9rem;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      min-width: 220px;
    }
  </style>
</head>

<body>
  <h1>ğŸ² ITéƒ¨ ãƒœãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ä¸€è¦§</h1>

  <div class="controls">
    <input
      type="text"
      id="search"
      placeholder="ğŸ” ã‚²ãƒ¼ãƒ åãƒ»ã‚¸ãƒ£ãƒ³ãƒ«ãƒ»èª¬æ˜ã§æ¤œç´¢"
    />

    <select id="sort">
      <option value="">ä¸¦ã³æ›¿ãˆ</option>
      <option value="name">åå‰ï¼ˆAâ†’Zï¼‰</option>
      <option value="difficulty">é›£æ˜“åº¦</option>
      <option value="players">äººæ•°</option>
      <option value="time">æ™‚é–“</option>
    </select>
  </div>

  <div id="list"></div>

  <script>
    let games = [];

    const sheetId = "1wwxgmxSW5MPJuh823423OUL0Nc9h5wWvvvfIbWWJhds";
    const sheetName = "ITéƒ¨ãƒœãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ ä¸€è¦§";

    fetch(
      `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`
    )
      .then(res => res.text())
      .then(text => {
        const json = JSON.parse(text.substring(47, text.length - 2));
        const rows = json.table.rows;

        games = rows.map(row => {
          const [
            no,
            name,
            genre,
            summary,
            difficulty,
            players,
            time,
            link,
            image
          ] = row.c.map(c => (c ? c.v : ""));

          return {
            name,
            genre,
            summary,
            difficulty,
            players,
            time,
            link,
            image
          };
        });

        render(games);
      });

    function render(listData) {
      const list = document.getElementById("list");
      list.innerHTML = "";

      listData.forEach(game => {
        const card = document.createElement("div");
        card.className = "game-card";

        card.innerHTML = `
          <div class="image">
            ${game.image ? `<img src="${game.image}" alt="${game.name}">`: `<div class="no-image">No Image</div>`}
          </div>
          <div class="description">
            <div class="title">${game.name}</div>
            <div class="genre">${game.genre}</div>
            <div class="summary">${game.summary}</div>
            <div class="meta">
              <span class="badge">é›£æ˜“åº¦: ${game.difficulty}</span>
              <span class="badge">äººæ•°: ${game.players}</span>
              <span class="badge">æ™‚é–“: ${game.time}</span>
            </div>
            ${
              game.link
                ? `<a href="${game.link}" target="_blank">ğŸ“– èª¬æ˜æ›¸ï¼ˆå¤–éƒ¨ï¼‰</a>`
                : ""
            }
          </div>
        `;

        list.appendChild(card);
      });
    }

    document.getElementById("search").addEventListener("input", e => {
      const keyword = e.target.value.toLowerCase();

      const filtered = games.filter(g =>
        [g.name, g.genre, g.summary]
          .join(" ")
          .toLowerCase()
          .includes(keyword)
      );

      render(filtered);
    });

    document.getElementById("sort").addEventListener("change", e => {
      const type = e.target.value;
      const sorted = [...games];

      if (type === "name") {
        sorted.sort((a, b) => a.name.localeCompare(b.name));
      }

      if (type === "difficulty") {
        sorted.sort((a, b) => a.difficulty.localeCompare(b.difficulty));
      }

      if (type === "players") {
        sorted.sort((a, b) => a.players.localeCompare(b.players));
      }

      if (type === "time") {
        sorted.sort((a, b) => a.time.localeCompare(b.time));
      }

      render(sorted);
    });
  </script>
</body>
</html>
