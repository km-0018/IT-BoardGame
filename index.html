<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>IT部ボードゲーム一覧</title>
  <style>
    .game-card {
      border: 1px solid #ccc;
      padding: 12px;
      margin: 10px;
      border-radius: 8px;
      background: #fafafa;
    }
    .title {
      font-size: 1.2em;
      font-weight: bold;
    }
    .genre {
      color: #666;
      margin-bottom: 6px;
    }
    .card {
      display: flex;
    }
  </style>
</head>
<body>

<h1>IT部ボードゲーム一覧</h1>
<div id="list"></div>

<script>
const sheetId = "1wwxgmxSW5MPJuh823423OUL0Nc9h5wWvvvfIbWWJhds";
const sheetName = "IT部ボードゲーム一覧";

fetch(`https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`)
  .then(res => res.text())
  .then(text => {
    // gvizの先頭と末尾を削る
    const json = JSON.parse(text.substring(47, text.length - 2));
    const rows = json.table.rows;

    const list = document.getElementById("list");

    rows.forEach(row => {
      const [no, name, genre, summary, difficulty, players, time, link, image] =
        row.c.map(c => c ? c.v : "");

      const card = document.createElement("div");
      card.className = "game-card";
      card.innerHTML = `
        <div class="card">
          <div class="image">
            <image src="${image}" />
          </div>
          <div class="description">
            <div class="title">${name}</div>
            <div class="genre">${genre}</div>
            <div class="summary">${summary}</div>
            <div><b>難易度:</b> ${difficulty}</div>
            <div><b>人数:</b> ${players}</div>
            <div><b>時間:</b> ${time}</div>
            ${
              link
                ? `<div><a href="${link}" target="_blank">説明書リンク</a></div>`
                : ""
            }
            </div>
        </div>
      `;

      list.appendChild(card);
    });
  });
</script>

</body>
</html>
